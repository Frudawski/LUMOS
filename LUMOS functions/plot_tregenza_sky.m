function plot_tregenza_sky(data,color,mode)

cla
colorbar('off')
legend off;

% indcator for color or bw plot
if color == 1
    plot_rgb = 1;
else
    plot_rgb = 0;
end

%{
% calculate L for patch
CIExyz = [360.00000000000000	361.00000000000000	362.00000000000000	363.00000000000000	364.00000000000000	365.00000000000000	366.00000000000000	367.00000000000000	368.00000000000000	369.00000000000000	370.00000000000000	371.00000000000000	372.00000000000000	373.00000000000000	374.00000000000000	375.00000000000000	376.00000000000000	377.00000000000000	378.00000000000000	379.00000000000000	380.00000000000000	381.00000000000000	382.00000000000000	383.00000000000000	384.00000000000000	385.00000000000000	386.00000000000000	387.00000000000000	388.00000000000000	389.00000000000000	390.00000000000000	391.00000000000000	392.00000000000000	393.00000000000000	394.00000000000000	395.00000000000000	396.00000000000000	397.00000000000000	398.00000000000000	399.00000000000000	400.00000000000000	401.00000000000000	402.00000000000000	403.00000000000000	404.00000000000000	405.00000000000000	406.00000000000000	407.00000000000000	408.00000000000000	409.00000000000000	410.00000000000000	411.00000000000000	412.00000000000000	413.00000000000000	414.00000000000000	415.00000000000000	416.00000000000000	417.00000000000000	418.00000000000000	419.00000000000000	420.00000000000000	421.00000000000000	422.00000000000000	423.00000000000000	424.00000000000000	425.00000000000000	426.00000000000000	427.00000000000000	428.00000000000000	429.00000000000000	430.00000000000000	431.00000000000000	432.00000000000000	433.00000000000000	434.00000000000000	435.00000000000000	436.00000000000000	437.00000000000000	438.00000000000000	439.00000000000000	440.00000000000000	441.00000000000000	442.00000000000000	443.00000000000000	444.00000000000000	445.00000000000000	446.00000000000000	447.00000000000000	448.00000000000000	449.00000000000000	450.00000000000000	451.00000000000000	452.00000000000000	453.00000000000000	454.00000000000000	455.00000000000000	456.00000000000000	457.00000000000000	458.00000000000000	459.00000000000000	460.00000000000000	461.00000000000000	462.00000000000000	463.00000000000000	464.00000000000000	465.00000000000000	466.00000000000000	467.00000000000000	468.00000000000000	469.00000000000000	470.00000000000000	471.00000000000000	472.00000000000000	473.00000000000000	474.00000000000000	475.00000000000000	476.00000000000000	477.00000000000000	478.00000000000000	479.00000000000000	480.00000000000000	481.00000000000000	482.00000000000000	483.00000000000000	484.00000000000000	485.00000000000000	486.00000000000000	487.00000000000000	488.00000000000000	489.00000000000000	490.00000000000000	491.00000000000000	492.00000000000000	493.00000000000000	494.00000000000000	495.00000000000000	496.00000000000000	497.00000000000000	498.00000000000000	499.00000000000000	500.00000000000000	501.00000000000000	502.00000000000000	503.00000000000000	504.00000000000000	505.00000000000000	506.00000000000000	507.00000000000000	508.00000000000000	509.00000000000000	510.00000000000000	511.00000000000000	512.00000000000000	513.00000000000000	514.00000000000000	515.00000000000000	516.00000000000000	517.00000000000000	518.00000000000000	519.00000000000000	520.00000000000000	521.00000000000000	522.00000000000000	523.00000000000000	524.00000000000000	525.00000000000000	526.00000000000000	527.00000000000000	528.00000000000000	529.00000000000000	530.00000000000000	531.00000000000000	532.00000000000000	533.00000000000000	534.00000000000000	535.00000000000000	536.00000000000000	537.00000000000000	538.00000000000000	539.00000000000000	540.00000000000000	541.00000000000000	542.00000000000000	543.00000000000000	544.00000000000000	545.00000000000000	546.00000000000000	547.00000000000000	548.00000000000000	549.00000000000000	550.00000000000000	551.00000000000000	552.00000000000000	553.00000000000000	554.00000000000000	555.00000000000000	556.00000000000000	557.00000000000000	558.00000000000000	559.00000000000000	560.00000000000000	561.00000000000000	562.00000000000000	563.00000000000000	564.00000000000000	565.00000000000000	566.00000000000000	567.00000000000000	568.00000000000000	569.00000000000000	570.00000000000000	571.00000000000000	572.00000000000000	573.00000000000000	574.00000000000000	575.00000000000000	576.00000000000000	577.00000000000000	578.00000000000000	579.00000000000000	580.00000000000000	581.00000000000000	582.00000000000000	583.00000000000000	584.00000000000000	585.00000000000000	586.00000000000000	587.00000000000000	588.00000000000000	589.00000000000000	590.00000000000000	591.00000000000000	592.00000000000000	593.00000000000000	594.00000000000000	595.00000000000000	596.00000000000000	597.00000000000000	598.00000000000000	599.00000000000000	600.00000000000000	601.00000000000000	602.00000000000000	603.00000000000000	604.00000000000000	605.00000000000000	606.00000000000000	607.00000000000000	608.00000000000000	609.00000000000000	610.00000000000000	611.00000000000000	612.00000000000000	613.00000000000000	614.00000000000000	615.00000000000000	616.00000000000000	617.00000000000000	618.00000000000000	619.00000000000000	620.00000000000000	621.00000000000000	622.00000000000000	623.00000000000000	624.00000000000000	625.00000000000000	626.00000000000000	627.00000000000000	628.00000000000000	629.00000000000000	630.00000000000000	631.00000000000000	632.00000000000000	633.00000000000000	634.00000000000000	635.00000000000000	636.00000000000000	637.00000000000000	638.00000000000000	639.00000000000000	640.00000000000000	641.00000000000000	642.00000000000000	643.00000000000000	644.00000000000000	645.00000000000000	646.00000000000000	647.00000000000000	648.00000000000000	649.00000000000000	650.00000000000000	651.00000000000000	652.00000000000000	653.00000000000000	654.00000000000000	655.00000000000000	656.00000000000000	657.00000000000000	658.00000000000000	659.00000000000000	660.00000000000000	661.00000000000000	662.00000000000000	663.00000000000000	664.00000000000000	665.00000000000000	666.00000000000000	667.00000000000000	668.00000000000000	669.00000000000000	670.00000000000000	671.00000000000000	672.00000000000000	673.00000000000000	674.00000000000000	675.00000000000000	676.00000000000000	677.00000000000000	678.00000000000000	679.00000000000000	680.00000000000000	681.00000000000000	682.00000000000000	683.00000000000000	684.00000000000000	685.00000000000000	686.00000000000000	687.00000000000000	688.00000000000000	689.00000000000000	690.00000000000000	691.00000000000000	692.00000000000000	693.00000000000000	694.00000000000000	695.00000000000000	696.00000000000000	697.00000000000000	698.00000000000000	699.00000000000000	700.00000000000000	701.00000000000000	702.00000000000000	703.00000000000000	704.00000000000000	705.00000000000000	706.00000000000000	707.00000000000000	708.00000000000000	709.00000000000000	710.00000000000000	711.00000000000000	712.00000000000000	713.00000000000000	714.00000000000000	715.00000000000000	716.00000000000000	717.00000000000000	718.00000000000000	719.00000000000000	720.00000000000000	721.00000000000000	722.00000000000000	723.00000000000000	724.00000000000000	725.00000000000000	726.00000000000000	727.00000000000000	728.00000000000000	729.00000000000000	730.00000000000000	731.00000000000000	732.00000000000000	733.00000000000000	734.00000000000000	735.00000000000000	736.00000000000000	737.00000000000000	738.00000000000000	739.00000000000000	740.00000000000000	741.00000000000000	742.00000000000000	743.00000000000000	744.00000000000000	745.00000000000000	746.00000000000000	747.00000000000000	748.00000000000000	749.00000000000000	750.00000000000000	751.00000000000000	752.00000000000000	753.00000000000000	754.00000000000000	755.00000000000000	756.00000000000000	757.00000000000000	758.00000000000000	759.00000000000000	760.00000000000000	761.00000000000000	762.00000000000000	763.00000000000000	764.00000000000000	765.00000000000000	766.00000000000000	767.00000000000000	768.00000000000000	769.00000000000000	770.00000000000000	771.00000000000000	772.00000000000000	773.00000000000000	774.00000000000000	775.00000000000000	776.00000000000000	777.00000000000000	778.00000000000000	779.00000000000000	780.00000000000000	781.00000000000000	782.00000000000000	783.00000000000000	784.00000000000000	785.00000000000000	786.00000000000000	787.00000000000000	788.00000000000000	789.00000000000000	790.00000000000000	791.00000000000000	792.00000000000000	793.00000000000000	794.00000000000000	795.00000000000000	796.00000000000000	797.00000000000000	798.00000000000000	799.00000000000000	800.00000000000000	801.00000000000000	802.00000000000000	803.00000000000000	804.00000000000000	805.00000000000000	806.00000000000000	807.00000000000000	808.00000000000000	809.00000000000000	810.00000000000000	811.00000000000000	812.00000000000000	813.00000000000000	814.00000000000000	815.00000000000000	816.00000000000000	817.00000000000000	818.00000000000000	819.00000000000000	820.00000000000000	821.00000000000000	822.00000000000000	823.00000000000000	824.00000000000000	825.00000000000000	826.00000000000000	827.00000000000000	828.00000000000000	829.00000000000000	830.00000000000000
    0.00012990000000	0.00014584700000	0.00016380210000	0.00018400370000	0.00020669020000	0.00023210000000	0.00026072800000	0.00029307500000	0.00032938800000	0.00036991400000	0.00041490000000	0.00046415870000	0.00051898600000	0.00058185400000	0.00065523470000	0.00074160000000	0.00084502960000	0.00096452680000	0.00109494900000	0.00123115400000	0.00136800000000	0.00150205000000	0.00164232800000	0.00180238200000	0.00199575700000	0.00223600000000	0.00253538500000	0.00289260300000	0.00330082900000	0.00375323600000	0.00424300000000	0.00476238900000	0.00533004800000	0.00597871200000	0.00674111700000	0.00765000000000	0.00875137300000	0.01002888000000	0.01142170000000	0.01286901000000	0.01431000000000	0.01570443000000	0.01714744000000	0.01878122000000	0.02074801000000	0.02319000000000	0.02620736000000	0.02978248000000	0.03388092000000	0.03846824000000	0.04351000000000	0.04899560000000	0.05502260000000	0.06171880000000	0.06921200000000	0.07763000000000	0.08695811000000	0.09717672000000	0.10840630000000	0.12076720000000	0.13438000000000	0.14935820000000	0.16539570000000	0.18198310000000	0.19861100000000	0.21477000000000	0.23018680000000	0.24487970000000	0.25877730000000	0.27180790000000	0.28390000000000	0.29494380000000	0.30489650000000	0.31378730000000	0.32164540000000	0.32850000000000	0.33435130000000	0.33921010000000	0.34312130000000	0.34612960000000	0.34828000000000	0.34959990000000	0.35014740000000	0.35001300000000	0.34928700000000	0.34806000000000	0.34637330000000	0.34426240000000	0.34180880000000	0.33909410000000	0.33620000000000	0.33319770000000	0.33004110000000	0.32663570000000	0.32288680000000	0.31870000000000	0.31402510000000	0.30888400000000	0.30329040000000	0.29725790000000	0.29080000000000	0.28397010000000	0.27672140000000	0.26891780000000	0.26042270000000	0.25110000000000	0.24084750000000	0.22985120000000	0.21840720000000	0.20681150000000	0.19536000000000	0.18421360000000	0.17332730000000	0.16268810000000	0.15228330000000	0.14210000000000	0.13217860000000	0.12256960000000	0.11327520000000	0.10429790000000	0.09564000000000	0.08729955000000	0.07930804000000	0.07171776000000	0.06458099000000	0.05795001000000	0.05186211000000	0.04628152000000	0.04115088000000	0.03641283000000	0.03201000000000	0.02791720000000	0.02414440000000	0.02068700000000	0.01754040000000	0.01470000000000	0.01216179000000	0.00991996000000	0.00796724000000	0.00629634600000	0.00490000000000	0.00377717300000	0.00294532000000	0.00242488000000	0.00223629300000	0.00240000000000	0.00292552000000	0.00383656000000	0.00517484000000	0.00698208000000	0.00930000000000	0.01214949000000	0.01553588000000	0.01947752000000	0.02399277000000	0.02910000000000	0.03481485000000	0.04112016000000	0.04798504000000	0.05537861000000	0.06327000000000	0.07163501000000	0.08046224000000	0.08973996000000	0.09945645000000	0.10960000000000	0.12016740000000	0.13111450000000	0.14236790000000	0.15385420000000	0.16550000000000	0.17725710000000	0.18914000000000	0.20116940000000	0.21336580000000	0.22574990000000	0.23832090000000	0.25106680000000	0.26399220000000	0.27710170000000	0.29040000000000	0.30389120000000	0.31757260000000	0.33143840000000	0.34548280000000	0.35970000000000	0.37408390000000	0.38863960000000	0.40337840000000	0.41831150000000	0.43344990000000	0.44879530000000	0.46433600000000	0.48006400000000	0.49597130000000	0.51205010000000	0.52829590000000	0.54469160000000	0.56120940000000	0.57782150000000	0.59450000000000	0.61122090000000	0.62797580000000	0.64476020000000	0.66156970000000	0.67840000000000	0.69523920000000	0.71205860000000	0.72882840000000	0.74551880000000	0.76210000000000	0.77854320000000	0.79482560000000	0.81092640000000	0.82682480000000	0.84250000000000	0.85793250000000	0.87308160000000	0.88789440000000	0.90231810000000	0.91630000000000	0.92979950000000	0.94279840000000	0.95527760000000	0.96721790000000	0.97860000000000	0.98938560000000	0.99954880000000	1.00908920000000	1.01800640000000	1.02630000000000	1.03398270000000	1.04098600000000	1.04718800000000	1.05246670000000	1.05670000000000	1.05979440000000	1.06179920000000	1.06280680000000	1.06290960000000	1.06220000000000	1.06073520000000	1.05844360000000	1.05522440000000	1.05097680000000	1.04560000000000	1.03903690000000	1.03136080000000	1.02266620000000	1.01304770000000	1.00260000000000	0.99136750000000	0.97933140000000	0.96649160000000	0.95284790000000	0.93840000000000	0.92319400000000	0.90724400000000	0.89050200000000	0.87292000000000	0.85444990000000	0.83508400000000	0.81494600000000	0.79418600000000	0.77295400000000	0.75140000000000	0.72958360000000	0.70758880000000	0.68560220000000	0.66381040000000	0.64240000000000	0.62151490000000	0.60111380000000	0.58110520000000	0.56139770000000	0.54190000000000	0.52259950000000	0.50354640000000	0.48474360000000	0.46619390000000	0.44790000000000	0.42986130000000	0.41209800000000	0.39464400000000	0.37753330000000	0.36080000000000	0.34445630000000	0.32851680000000	0.31301920000000	0.29800110000000	0.28350000000000	0.26954480000000	0.25611840000000	0.24318960000000	0.23072720000000	0.21870000000000	0.20709710000000	0.19592320000000	0.18517080000000	0.17483230000000	0.16490000000000	0.15536670000000	0.14623000000000	0.13749000000000	0.12914670000000	0.12120000000000	0.11363970000000	0.10646500000000	0.09969044000000	0.09333061000000	0.08740000000000	0.08190096000000	0.07680428000000	0.07207712000000	0.06768664000000	0.06360000000000	0.05980685000000	0.05628216000000	0.05297104000000	0.04981861000000	0.04677000000000	0.04378405000000	0.04087536000000	0.03807264000000	0.03540461000000	0.03290000000000	0.03056419000000	0.02838056000000	0.02634484000000	0.02445275000000	0.02270000000000	0.02108429000000	0.01959988000000	0.01823732000000	0.01698717000000	0.01584000000000	0.01479064000000	0.01383132000000	0.01294868000000	0.01212920000000	0.01135916000000	0.01062935000000	0.00993884600000	0.00928842200000	0.00867885400000	0.00811091600000	0.00758238800000	0.00708874600000	0.00662731300000	0.00619540800000	0.00579034600000	0.00540982600000	0.00505258300000	0.00471751200000	0.00440350700000	0.00410945700000	0.00383391300000	0.00357574800000	0.00333434200000	0.00310907500000	0.00289932700000	0.00270434800000	0.00252302000000	0.00235416800000	0.00219661600000	0.00204919000000	0.00191096000000	0.00178143800000	0.00166011000000	0.00154645900000	0.00143997100000	0.00134004200000	0.00124627500000	0.00115847100000	0.00107643000000	0.00099994930000	0.00092873580000	0.00086243320000	0.00080075030000	0.00074339600000	0.00069007860000	0.00064051560000	0.00059450210000	0.00055186460000	0.00051242900000	0.00047602130000	0.00044245360000	0.00041151170000	0.00038298140000	0.00035664910000	0.00033230110000	0.00030975860000	0.00028888710000	0.00026953940000	0.00025156820000	0.00023482610000	0.00021917100000	0.00020452580000	0.00019084050000	0.00017806540000	0.00016615050000	0.00015502360000	0.00014462190000	0.00013490980000	0.00012585200000	0.00011741300000	0.00010955150000	0.00010222450000	0.00009539445000	0.00008902390000	0.00008307527000	0.00007751269000	0.00007231304000	0.00006745778000	0.00006292844000	0.00005870652000	0.00005477028000	0.00005109918000	0.00004767654000	0.00004448567000	0.00004150994000	0.00003873324000	0.00003614203000	0.00003372352000	0.00003146487000	0.00002935326000	0.00002737573000	0.00002552433000	0.00002379376000	0.00002217870000	0.00002067383000	0.00001927226000	0.00001796640000	0.00001674991000	0.00001561648000	0.00001455977000	0.00001357387000	0.00001265436000	0.00001179723000	0.00001099844000	0.00001025398000	0.00000955964600	0.00000891204400	0.00000830835800	0.00000774576900	0.00000722145600	0.00000673247500	0.00000627642300	0.00000585130400	0.00000545511800	0.00000508586800	0.00000474146600	0.00000442023600	0.00000412078300	0.00000384171600	0.00000358165200	0.00000333912700	0.00000311294900	0.00000290212100	0.00000270564500	0.00000252252500	0.00000235172600	0.00000219241500	0.00000204390200	0.00000190549700	0.00000177650900	0.00000165621500	0.00000154402200	0.00000143944000	0.00000134197700	0.00000125114100
    0.00000391700000	0.00000439358100	0.00000492960400	0.00000553213600	0.00000620824500	0.00000696500000	0.00000781321900	0.00000876733600	0.00000983984400	0.00001104323000	0.00001239000000	0.00001388641000	0.00001555728000	0.00001744296000	0.00001958375000	0.00002202000000	0.00002483965000	0.00002804126000	0.00003153104000	0.00003521521000	0.00003900000000	0.00004282640000	0.00004691460000	0.00005158960000	0.00005717640000	0.00006400000000	0.00007234421000	0.00008221224000	0.00009350816000	0.00010613610000	0.00012000000000	0.00013498400000	0.00015149200000	0.00017020800000	0.00019181600000	0.00021700000000	0.00024690670000	0.00028124000000	0.00031852000000	0.00035726670000	0.00039600000000	0.00043371470000	0.00047302400000	0.00051787600000	0.00057221870000	0.00064000000000	0.00072456000000	0.00082550000000	0.00094116000000	0.00106988000000	0.00121000000000	0.00136209100000	0.00153075200000	0.00172036800000	0.00193532300000	0.00218000000000	0.00245480000000	0.00276400000000	0.00311780000000	0.00352640000000	0.00400000000000	0.00454624000000	0.00515932000000	0.00582928000000	0.00654616000000	0.00730000000000	0.00808650700000	0.00890872000000	0.00976768000000	0.01066443000000	0.01160000000000	0.01257317000000	0.01358272000000	0.01462968000000	0.01571509000000	0.01684000000000	0.01800736000000	0.01921448000000	0.02045392000000	0.02171824000000	0.02300000000000	0.02429461000000	0.02561024000000	0.02695857000000	0.02835125000000	0.02980000000000	0.03131083000000	0.03288368000000	0.03452112000000	0.03622571000000	0.03800000000000	0.03984667000000	0.04176800000000	0.04376600000000	0.04584267000000	0.04800000000000	0.05024368000000	0.05257304000000	0.05498056000000	0.05745872000000	0.06000000000000	0.06260197000000	0.06527752000000	0.06804208000000	0.07091109000000	0.07390000000000	0.07701600000000	0.08026640000000	0.08366680000000	0.08723280000000	0.09098000000000	0.09491755000000	0.09904584000000	0.10336740000000	0.10788460000000	0.11260000000000	0.11753200000000	0.12267440000000	0.12799280000000	0.13345280000000	0.13902000000000	0.14467640000000	0.15046930000000	0.15646190000000	0.16271770000000	0.16930000000000	0.17624310000000	0.18355810000000	0.19127350000000	0.19941800000000	0.20802000000000	0.21711990000000	0.22673450000000	0.23685710000000	0.24748120000000	0.25860000000000	0.27018490000000	0.28229390000000	0.29505050000000	0.30857800000000	0.32300000000000	0.33840210000000	0.35468580000000	0.37169860000000	0.38928750000000	0.40730000000000	0.42562990000000	0.44430960000000	0.46339440000000	0.48293950000000	0.50300000000000	0.52356930000000	0.54451200000000	0.56569000000000	0.58696530000000	0.60820000000000	0.62934560000000	0.65030680000000	0.67087520000000	0.69084240000000	0.71000000000000	0.72818520000000	0.74546360000000	0.76196940000000	0.77783680000000	0.79320000000000	0.80811040000000	0.82249620000000	0.83630680000000	0.84949160000000	0.86200000000000	0.87381080000000	0.88496240000000	0.89549360000000	0.90544320000000	0.91485010000000	0.92373480000000	0.93209240000000	0.93992260000000	0.94722520000000	0.95400000000000	0.96025610000000	0.96600740000000	0.97126060000000	0.97602250000000	0.98030000000000	0.98409240000000	0.98741820000000	0.99031280000000	0.99281160000000	0.99495010000000	0.99671080000000	0.99809830000000	0.99911200000000	0.99974820000000	1.00000000000000	0.99985670000000	0.99930460000000	0.99832550000000	0.99689870000000	0.99500000000000	0.99260050000000	0.98974260000000	0.98644440000000	0.98272410000000	0.97860000000000	0.97408370000000	0.96917120000000	0.96385680000000	0.95813490000000	0.95200000000000	0.94545040000000	0.93849920000000	0.93116280000000	0.92345760000000	0.91540000000000	0.90700640000000	0.89827720000000	0.88920480000000	0.87978160000000	0.87000000000000	0.85986130000000	0.84939200000000	0.83862200000000	0.82758130000000	0.81630000000000	0.80479470000000	0.79308200000000	0.78119200000000	0.76915470000000	0.75700000000000	0.74475410000000	0.73242240000000	0.72000360000000	0.70749650000000	0.69490000000000	0.68221920000000	0.66947160000000	0.65667440000000	0.64384480000000	0.63100000000000	0.61815550000000	0.60531440000000	0.59247560000000	0.57963790000000	0.56680000000000	0.55396110000000	0.54113720000000	0.52835280000000	0.51563230000000	0.50300000000000	0.49046880000000	0.47803040000000	0.46567760000000	0.45340320000000	0.44120000000000	0.42908000000000	0.41703600000000	0.40503200000000	0.39303200000000	0.38100000000000	0.36891840000000	0.35682720000000	0.34477680000000	0.33281760000000	0.32100000000000	0.30933810000000	0.29785040000000	0.28659360000000	0.27562450000000	0.26500000000000	0.25476320000000	0.24488960000000	0.23533440000000	0.22605280000000	0.21700000000000	0.20816160000000	0.19954880000000	0.19115520000000	0.18297440000000	0.17500000000000	0.16722350000000	0.15964640000000	0.15227760000000	0.14512590000000	0.13820000000000	0.13150030000000	0.12502480000000	0.11877920000000	0.11276910000000	0.10700000000000	0.10147620000000	0.09618864000000	0.09112296000000	0.08626485000000	0.08160000000000	0.07712064000000	0.07282552000000	0.06871008000000	0.06476976000000	0.06100000000000	0.05739621000000	0.05395504000000	0.05067376000000	0.04754965000000	0.04458000000000	0.04175872000000	0.03908496000000	0.03656384000000	0.03420048000000	0.03200000000000	0.02996261000000	0.02807664000000	0.02632936000000	0.02470805000000	0.02320000000000	0.02180077000000	0.02050112000000	0.01928108000000	0.01812069000000	0.01700000000000	0.01590379000000	0.01483718000000	0.01381068000000	0.01283478000000	0.01192000000000	0.01106831000000	0.01027339000000	0.00953331100000	0.00884615700000	0.00821000000000	0.00762378100000	0.00708542400000	0.00659147600000	0.00613848500000	0.00572300000000	0.00534305900000	0.00499579600000	0.00467640400000	0.00438007500000	0.00410200000000	0.00383845300000	0.00358909900000	0.00335421900000	0.00313409300000	0.00292900000000	0.00273813900000	0.00255987600000	0.00239324400000	0.00223727500000	0.00209100000000	0.00195358700000	0.00182458000000	0.00170358000000	0.00159018700000	0.00148400000000	0.00138449600000	0.00129126800000	0.00120409200000	0.00112274400000	0.00104700000000	0.00097658960000	0.00091110880000	0.00085013320000	0.00079323840000	0.00074000000000	0.00069008270000	0.00064331000000	0.00059949600000	0.00055845470000	0.00052000000000	0.00048391360000	0.00045005280000	0.00041834520000	0.00038871840000	0.00036110000000	0.00033538350000	0.00031144040000	0.00028916560000	0.00026845390000	0.00024920000000	0.00023130190000	0.00021468560000	0.00019928840000	0.00018504750000	0.00017190000000	0.00015977810000	0.00014860440000	0.00013830160000	0.00012879250000	0.00012000000000	0.00011185950000	0.00010432240000	0.00009733560000	0.00009084587000	0.00008480000000	0.00007914667000	0.00007385800000	0.00006891600000	0.00006430267000	0.00006000000000	0.00005598187000	0.00005222560000	0.00004871840000	0.00004544747000	0.00004240000000	0.00003956104000	0.00003691512000	0.00003444868000	0.00003214816000	0.00003000000000	0.00002799125000	0.00002611356000	0.00002436024000	0.00002272461000	0.00002120000000	0.00001977855000	0.00001845285000	0.00001721687000	0.00001606459000	0.00001499000000	0.00001398728000	0.00001305155000	0.00001217818000	0.00001136254000	0.00001060000000	0.00000988587700	0.00000921730400	0.00000859236200	0.00000800913300	0.00000746570000	0.00000695956700	0.00000648799500	0.00000604869900	0.00000563939600	0.00000525780000	0.00000490177100	0.00000456972000	0.00000426019400	0.00000397173900	0.00000370290000	0.00000345216300	0.00000321830200	0.00000300030000	0.00000279713900	0.00000260780000	0.00000243122000	0.00000226653100	0.00000211301300	0.00000196994300	0.00000183660000	0.00000171223000	0.00000159622800	0.00000148809000	0.00000138731400	0.00000129340000	0.00000120582000	0.00000112414300	0.00000104800900	0.00000097705780	0.00000091093000	0.00000084925130	0.00000079172120	0.00000073809040	0.00000068810980	0.00000064153000	0.00000059808950	0.00000055757460	0.00000051980800	0.00000048461230	0.00000045181000
    0.00060610000000	0.00068087920000	0.00076514560000	0.00086001240000	0.00096659280000	0.00108600000000	0.00122058600000	0.00137272900000	0.00154357900000	0.00173428600000	0.00194600000000	0.00217777700000	0.00243580900000	0.00273195300000	0.00307806400000	0.00348600000000	0.00397522700000	0.00454088000000	0.00515832000000	0.00580290700000	0.00645000100000	0.00708321600000	0.00774548800000	0.00850115200000	0.00941454400000	0.01054999000000	0.01196580000000	0.01365587000000	0.01558805000000	0.01773015000000	0.02005001000000	0.02251136000000	0.02520288000000	0.02827972000000	0.03189704000000	0.03621000000000	0.04143771000000	0.04750372000000	0.05411988000000	0.06099803000000	0.06785001000000	0.07448632000000	0.08136156000000	0.08915364000000	0.09854048000000	0.11020000000000	0.12461330000000	0.14170170000000	0.16130350000000	0.18325680000000	0.20740000000000	0.23369210000000	0.26261140000000	0.29477460000000	0.33079850000000	0.37130000000000	0.41620910000000	0.46546420000000	0.51969480000000	0.57953030000000	0.64560000000000	0.71848380000000	0.79671330000000	0.87784590000000	0.95943900000000	1.03905010000000	1.11536730000000	1.18849710000000	1.25812330000000	1.32392960000000	1.38560000000000	1.44263520000000	1.49480350000000	1.54219030000000	1.58488070000000	1.62296000000000	1.65640480000000	1.68529590000000	1.70987450000000	1.73038210000000	1.74706000000000	1.76004460000000	1.76962330000000	1.77626370000000	1.78043340000000	1.78260000000000	1.78296820000000	1.78169980000000	1.77919820000000	1.77586710000000	1.77211000000000	1.76825890000000	1.76403900000000	1.75894380000000	1.75246630000000	1.74410000000000	1.73355950000000	1.72085810000000	1.70593690000000	1.68873720000000	1.66920000000000	1.64752870000000	1.62341270000000	1.59602230000000	1.56452800000000	1.52810000000000	1.48611140000000	1.43952150000000	1.38987990000000	1.33873620000000	1.28764000000000	1.23742230000000	1.18782430000000	1.13876110000000	1.09014800000000	1.04190000000000	0.99419760000000	0.94734730000000	0.90145310000000	0.85661930000000	0.81295010000000	0.77051730000000	0.72944480000000	0.68991360000000	0.65210490000000	0.61620000000000	0.58232860000000	0.55041620000000	0.52033760000000	0.49196730000000	0.46518000000000	0.43992460000000	0.41618360000000	0.39388220000000	0.37294590000000	0.35330000000000	0.33485780000000	0.31755210000000	0.30133750000000	0.28616860000000	0.27200000000000	0.25881710000000	0.24648380000000	0.23477180000000	0.22345330000000	0.21230000000000	0.20116920000000	0.19011960000000	0.17922540000000	0.16856080000000	0.15820000000000	0.14813830000000	0.13837580000000	0.12899420000000	0.12007510000000	0.11170000000000	0.10390480000000	0.09666748000000	0.08998272000000	0.08384531000000	0.07824999000000	0.07320899000000	0.06867816000000	0.06456784000000	0.06078835000000	0.05725001000000	0.05390435000000	0.05074664000000	0.04775276000000	0.04489859000000	0.04216000000000	0.03950728000000	0.03693564000000	0.03445836000000	0.03208872000000	0.02984000000000	0.02771181000000	0.02569444000000	0.02378716000000	0.02198925000000	0.02030000000000	0.01871805000000	0.01724036000000	0.01586364000000	0.01458461000000	0.01340000000000	0.01230723000000	0.01130188000000	0.01037792000000	0.00952930600000	0.00874999900000	0.00803520000000	0.00738160000000	0.00678540000000	0.00624280000000	0.00574999900000	0.00530360000000	0.00489980000000	0.00453420000000	0.00420240000000	0.00390000000000	0.00362320000000	0.00337060000000	0.00314140000000	0.00293480000000	0.00274999900000	0.00258520000000	0.00243860000000	0.00230940000000	0.00219680000000	0.00210000000000	0.00201773300000	0.00194820000000	0.00188980000000	0.00184093300000	0.00180000000000	0.00176626700000	0.00173780000000	0.00171120000000	0.00168306700000	0.00165000100000	0.00161013300000	0.00156440000000	0.00151360000000	0.00145853300000	0.00140000000000	0.00133666700000	0.00127000000000	0.00120500000000	0.00114666700000	0.00110000000000	0.00106880000000	0.00104940000000	0.00103560000000	0.00102120000000	0.00100000000000	0.00096864000000	0.00092992000000	0.00088688000000	0.00084256000000	0.00080000000000	0.00076096000000	0.00072368000000	0.00068592000000	0.00064544000000	0.00060000000000	0.00054786670000	0.00049160000000	0.00043540000000	0.00038346670000	0.00034000000000	0.00030725330000	0.00028316000000	0.00026544000000	0.00025181330000	0.00024000000000	0.00022954670000	0.00022064000000	0.00021196000000	0.00020218670000	0.00019000000000	0.00017421330000	0.00015564000000	0.00013596000000	0.00011685330000	0.00010000000000	0.00008613333000	0.00007460000000	0.00006500000000	0.00005693333000	0.00004999999000	0.00004416000000	0.00003948000000	0.00003572000000	0.00003264000000	0.00003000000000	0.00002765333000	0.00002556000000	0.00002364000000	0.00002181333000	0.00002000000000	0.00001813333000	0.00001620000000	0.00001420000000	0.00001213333000	0.00001000000000	0.00000773333300	0.00000540000000	0.00000320000000	0.00000133333300	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000	0.00000000000000];

% start and stop index for multiplication
ics = find(CIExyz(1,:)==380);
%CIExyz(1,ics)
ice = find(CIExyz(1,:)==780);
%CIExyz(1,ice)
VL = CIExyz(3,ics:ice);

ids = find(data(1,:)==CIExyz(1,ics));
%data(1,ids)
ide = find(data(1,:)==CIExyz(1,ice));
%data(1,ide)

L = VL * data(2:end,ids:ide)' .* 683;
% nm to m
%L = L/1e9;

% LAB RGB values
ics = find(CIExyz(1,:)==360);
ice = find(CIExyz(1,:)==830);
CIEx = CIExyz(2,ics:ice);
CIEy = CIExyz(3,ics:ice);
CIEz = CIExyz(4,ics:ice);

ids = find(data(1,:)==CIExyz(1,ics));
ide = find(data(1,:)==CIExyz(1,ice));
X = CIEx * data(2:end,ids:ide)' .*683;
Y = CIEy * data(2:end,ids:ide)' .*683;
Z = CIEz * data(2:end,ids:ide)' .*683;

x = X./(X+Y+Z);
y = Y./(X+Y+Z);
z = Z./(X+Y+Z);

xyz = [x' y' z'];
lab = xyz2lab(xyz,'WhitePoint','d65');
CLR = lab2rgb(lab,'WhitePoint','d65');
%}
L = data.L;
if size(L,1)<size(L,2)
    L = L';
end
clr = [L./max(L) L./max(L) L./max(L)];

% Tregenza table
tt = [1 30 6 12; 2 30 18 12; 3 24 30 15; 4 24 42 15; 5 18 54 20; 6 12 66 30; 7 6 78 60; 8 1 90 0];
% patch numbers and angles
% line 1: almucantars
% line 2: azimuths
% line 3: Patchnumber
pnt = [6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 6 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 18 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 30 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 42 54 54 54 54 54 54 54 54 54 54 54 54 54 54 54 54 54 54 66 66 66 66 66 66 66 66 66 66 66 66 78 78 78 78 78 78 90;180 192 204 216 228 240 252 264 276 288 300 312 324 336 348 0 12 24 36 48 60 72 84 96 108 120 132 144 156 168 168 156 144 132 120 108 96 84 72 60 48 36 24 12 0 348 336 324 312 300 288 276 264 252 240 228 216 204 192 180 180 195 210 225 240 255 270 285 300 315 330 345 0 15 30 45 60 75 90 105 120 135 150 165 165 150 135 120 105 90 75 60 45 30 15 0 345 330 315 300 285 270 255 240 225 210 195 180 180 200 220 240 260 280 300 320 340 0 20 40 60 80 100 120 140 160 150 120 90 60 30 0 330 300 270 240 210 180 180 240 300 0 60 120 NaN;1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145];

CLR = data.RGB;

r = 1;
els = 0;
hold on
if plot_rgb == 1
    clr = CLR;
end

% 3D mode
if strcmp(mode,'3D') == 1
    for al = 1:size(tt,1)-1
        % plot almucantar
        ps = tt(al,4)/2;
        for patch = 1:tt(al,2)
            az = -deg2rad([linspace(ps,ps+tt(al,4),50) linspace(ps+tt(al,4),ps,50) ps]-tt(al,4)-90);
            el = deg2rad([ones(1,50).*els ones(1,50).*(els+12) els]);
            [x,y,z] = sph2cart(az,el,r);
            % patchnumber
            pp = find(pnt(1,:)==tt(al,3));
            p  = find(pnt(2,pp)==ps-tt(al,4)/2);
            patchn = pnt(3,pp(p));
            if L(patchn)>0
                fill3(x,y,z,clr(patchn,:))
            else
                fill3(x,y,z,[1 0 0])
            end
            ps = ps+tt(al,4);
        end
        els = els + 12;
    end
    % zenith
    az = deg2rad(linspace(0,360,101));
    el = deg2rad(ones(1,101).*84);
    [x,y,z] = sph2cart(az,el,r);
    fill3(x,y,z,clr(patchn,:))
    title('sky')
    % set North South West East Markers
    text(0,100,0,'N','HorizontalAlignment','center','FontSize',12)
    text(0,-100,0,'S','HorizontalAlignment','center','FontSize',12)
    text(100,0,0,'E','HorizontalAlignment','center','FontSize',12)
    text(-100,0,0,'W','HorizontalAlignment','center','FontSize',12)
    
    % end mode 3D -> 2 D mode
elseif strcmp(mode,'2D') == 1
    r = 90;
    for al = 1:size(tt,1)-1
        % plot almucantar
        ps = tt(al,4)/2;
        for patch = 1:tt(al,2)
            az = -deg2rad([linspace(ps,ps+tt(al,4),50) linspace(ps+tt(al,4),ps,50) ps]-tt(al,4)-90);
            el = deg2rad([ones(1,50).*els ones(1,50).*(els+12) els]);
            [x,y] = pol2cart(az,[ones(1,50).*r ones(1,50).*(r-12) r]);
            % patchnumber
            pp = find(pnt(1,:)==tt(al,3));
            p  = find(pnt(2,pp)==ps-tt(al,4)/2);
            patchn = pnt(3,pp(p));
            if L(patchn)>0
                fill3(x,y,zeros(size(x)),clr(patchn,:))
                
            else
                fill3(x,y,zeros(size(x)),[1 0 0])
            end
            text(mean(x),mean(y),num2str(pp(p)),'FontSize',5,'HorizontalAlignment','center');
            hold on
            ps = ps+tt(al,4);
        end
        r = r-12;
    end
    % zenith
    az = deg2rad(linspace(0,360,101));
    patchn = 145;
    [x,y] = pol2cart(az,r);
    try
        fill3(x,y,zeros(size(x)),clr(patchn,:))
    catch
        fill3(x,y,zeros(size(x)),[1 0 0])
    end
    text(mean(x),mean(y),num2str(patchn),'FontSize',5,'HorizontalAlignment','center');
    
    title('')
    axis auto
    axis equal
    % set North South West East Markers
    text(0,100,'N','HorizontalAlignment','center','FontSize',12)
    text(0,-100,'S','HorizontalAlignment','center','FontSize',12)
    text(100,0,'E','HorizontalAlignment','center','FontSize',12)
    text(-100,0,'W','HorizontalAlignment','center','FontSize',12)
    
    % end of 2D mode -> explosion mode
elseif strcmp(mode,'explosion')
    
    %ax(1)=axes;
    %axis equal
    %axis off
    
    hold on
    width = 5;
    width = 90-width;
    axis([0 1 0 1 0 1])
    % normalize L
    f = L./max(L);
    r = 1;
    els = 6;
    hold on
    if plot_rgb == 1
        clr = CLR;
    end
    for al = 1:size(tt,1)-1
        % plot almucantar
        ps = 0;
        for patch = 1:tt(al,2)
            az = -deg2rad(ps-90);
            el = deg2rad(els);
            
            % patchnumber
            pp = find(pnt(1,:)==tt(al,3));
            p  = find(pnt(2,pp)==ps);
            patchn = pnt(3,pp(p));
            
            [x,y,z] = sph2cart(az,el,f(patchn));
            if L(patchn)>0 && ~isnan(clr(patchn,1))
                c = clr(patchn,:);
            else
                c = [1 0 0];
            end
            
            line = plot3([0 x],[0 y],[0 z],'-','Color',[0.35 0.35 0.35],'LineWidth',1);
            
            phi = deg2rad(linspace(0,360,101));
            theta = deg2rad(ones(1,101).*width);
            [x,y,z] = sph2cart(phi,theta,f(patchn));
            face = fill3(x,y,z,c);
            set(face,'EdgeColor',[0.35 0.35 0.35])
            rotate(face,[0 1 0],90-rad2deg(el),[0 0 0]);
            rotate(face,[0 0 1],rad2deg(az),[0 0 0]);
            
            ps = ps+tt(al,4);
        end
        els = els + 12;
    end
    % zenith
    az = deg2rad(0);
    el = deg2rad(90);
    [x,y,z] = sph2cart(az,el,f(145));
    line = plot3([0 x],[0 y],[0 z],'Color',[0.35 0.35 0.35]);
    
    phi = deg2rad(linspace(0,360,101));
    theta = deg2rad(ones(1,101).*width);
    [x,y,z] = sph2cart(phi,theta,f(145));
    face = fill3(x,y,z,c);
    set(face,'EdgeColor',[0.35 0.35 0.35])
    title('')
    axis  auto
    
    % set North arrow
    %plot3([0 0],[0 0.95],[0 0],'k')
    %plot3([-0.05 0 0.05],[0.90 0.95 0.90],[0 0 0],'k')
    %text(0,1.05,0,'N','HorizontalAlignment','center','FontSize',12)
    
    % GLOBUS 
    
    % circle
    a = axis;
    c = 10/1.5;
    
    width = max([abs(a(2)) abs(a(3))])*1.45/10;
    phi = deg2rad(linspace(0,360,101));
    theta = deg2rad(ones(1,101).*width);
    [x,y,z] = sph2cart(phi,theta,width);
    
    %ax(2)=axes;
    %axis equal
    %axis off
    %axis(a)
    %hold on
    
    g1 = plot3(x,y,z,'Color',[0.55 0.55 0.55],'LineWidth',0.5);
    g2 = plot3(x,y,z,'Color',[0.55 0.55 0.55],'LineWidth',0.5);
    g3 = plot3(x,y,z,'Color',[0.55 0.55 0.55],'LineWidth',0.5);
    rotate(g2,[0 1 0],90,[0 0 0]);
    rotate(g3,[1 0 0],90,[0 0 0]);
    g1.XData = g1.XData+width*c;
    g2.XData = g2.XData+width*c;
    g3.XData = g3.XData+width*c;
    g1.YData = g1.YData-width*c;
    g2.YData = g2.YData-width*c;
    g3.YData = g3.YData-width*c;
    [x,y,z] = sphere(50);
    globus = surf(x.*width+width*c, y.*width-width*c, z.*width);
    globus.EdgeColor = 'none';
    colormap(gray)
    %shading interp
    
    %set(globus, 'FaceColor', [0.9 0.9 0.9]);
    % Nord arrow
    f = 2;
    plot3([0 0]+width*c,[-f*width f*width]-width*c,[0 0],'Color',[0.55 0.55 0.55],'LineWidth',0.5)
    plot3([0 0]+width*c,[0 0]-width*c,[-f*width f*width],'Color',[0.55 0.55 0.55],'LineWidth',0.5)
    plot3([-f*width f*width]+width*c,[0 0]-width*c,[0 0],'Color',[0.55 0.55 0.55],'LineWidth',0.5)
    
    % arrowhead
    %{
    [x,y,z] = cylinder([1 0],50);
    z = z*1.5;
    x = x.*width/5;
    y = y.*width/5;
    z = z.*width/5;
    cyl = surf(x+width*c,y-width*c,z+f.*width);
    cyl.EdgeColor = 'none';
    set(cyl, 'FaceColor', [0.55 0.55 0.55]);

    cyl = surf(x,y,z);
    z = z*1.5;
    cyl.EdgeColor = 'none';
    set(cyl, 'FaceColor', [0.55 0.55 0.55]);
    rotate(cyl,[1 0 0],-90,[0 0 0]);
    cyl.XData = cyl.XData+width*c;
    cyl.YData = cyl.YData-width*c+f.*width;
    %}
    %{
    cyl = surf(x,y,z);
    cyl.EdgeColor = 'none';
    set(cyl, 'FaceColor', [0.35 0.35 0.35]);
    rotate(cyl,[0 1 0],90,[0 0 0]);
    cyl.XData = cyl.XData+width*10/2+f.*width;
    cyl.YData = cyl.YData-width*10/2;
    %}
    
    
    %camlight
    %light('Position',[1 0 0],'Style','infinite');
    
    text(width*c,-width*c+1.25*f.*width,0,'N','HorizontalAlignment','Center','VerticalAlignment','middle','Color',[0 0 0])
    text(width*c,-width*c,1.25*f.*width,'Z','HorizontalAlignment','Center','VerticalAlignment','middle','Color',[0 0 0])
    text(width*c,-width*c-1.25*f.*width,0,'S','HorizontalAlignment','Center','VerticalAlignment','middle','Color',[0 0 0])
    
    
    
end

hold off
axis equal
grid on
axis off


% end of function
end